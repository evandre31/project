{% extends 'base.html' %}


{% block content %}
    <h2>reset password</h2> {{ msg }}
    <span id="email_error" style="display: none"></span>
    <form method="post" data-validate-email-url="{% url 'accounts:validate_email'%}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-danger">request password reset</button>
    </form>
{% endblock %}
{% block javascript %}
    {#  check email #}
    <script>
        $('#id_email').keyup(function ggggggg () {    {# check email #}
            var email = $(this).val();
            var form = $(this).closest("form");
            $.ajax({
                url:form.attr("data-validate-email-url"),
                data:form.serialize(),
                dataType: 'json',
                success:function(data){
                    if (data.email_exist){
                        $('#email_error').text(data.error_message);
                        $("#email_error").css("display","block");
                    } else {
                        $('#email_error').text(data.error_message);
                        $("#email_error").css("display", "block");
                    }
                }
            });
        });
    </script> {#  end check email #}
{% endblock javascript %}